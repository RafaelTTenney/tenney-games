<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Profile | Games & Programs</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --primary: #3366cc; --muted:#666; --bg:#f6f8fb; --card:#fff; }
    body { background: var(--bg); font-family: Roboto, Arial, sans-serif; margin:0; padding:0; }
    header { background: var(--primary); color:#fff; padding:12px 16px; text-align:center; font-weight:700; }
    .container { max-width:720px; margin: 28px auto; background: var(--card); border-radius:10px; padding:18px; box-shadow:0 8px 24px rgba(51,102,204,0.08); }
    h1 { color:var(--primary); margin:0 0 8px 0; }
    .meta { color:var(--muted); margin-bottom:12px; }
    .status { font-weight:700; color:#254a99; background:#e6f0ff; padding:8px 10px; border-radius:8px; display:inline-block; }
      ul { color:var(--muted); }
    .btn { background:var(--primary); color:#fff; padding:8px 12px; border-radius:8px; text-decoration:none; font-weight:700; display:inline-block; margin-top:12px; }
    .btn.secondary { background:#fff; color:var(--primary); border:1px solid #99ccff; }
  </style>
</head>
<body>
  <header>Profile</header>
  <div class="container" id="profileContainer">
    <h1 id="profileName">Your Profile</h1>
    <div class="meta" id="profileEmail">Signed in as: <span id="profileUser">-</span></div>

    <div>
      <div>Account status: <span class="status" id="accountStatus">-</span></div>
      <div style="margin-top:12px;">
        <strong>What you can do with this account:</strong>
        <ul id="capabilitiesList"></ul>
      </div>

      <a id="upgradeBtn" class="btn" href="upgrade-request.html">Request an upgrade</a>
      <a id="backBtn" class="btn secondary" href="loggedIn.html" style="margin-left:12px;">Back to Dashboard</a>
    </div>
  </div>

  <footer style="text-align:center;padding:12px;color:#999;">&copy; 2025 Games & Programs | Contact: <a href="mailto:maintinence2025@outlook.com">maintinence2025@outlook.com</a></footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="supabase-client.js"></script>
  <script src="login.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      authHelpers.waitForAuthReady().then(async () => {
        if (!enforcePageAccess('profile.html')) return;
        const profile = await authHelpers.currentUserProfile();
        if (!profile) return;
        document.getElementById('profileUser').textContent = profile.username || (profile.email || 'Unknown');
        const displayName = profile.first_name ? `${profile.first_name} ${profile.last_name || ''}`.trim() : (profile.username || 'Player');
        document.getElementById('profileName').textContent = displayName;
        const status = (profile.account_status || 'standard').toLowerCase();
        document.getElementById('accountStatus').textContent = status.charAt(0).toUpperCase() + status.slice(1);

        const capabilities = {
          'standard': [
            'Access dashboard (loggedIn.html)',
            'Use Menu Guessers (menu-guesser.html)',
            'Play games (multi-game.html)'
          ],
          'advance': [
            'Everything a standard user can do',
            'Preview in-development games (preview-games.html)',
            'Play previews and submit bug reports & suggestions'
          ],
          'admin': [
            'Full access to the site',
            'Access experimental uploads (experimental.html)',
            'Access admin dashboard (admin.html) to monitor & manage accounts'
          ]
        };

        const list = document.getElementById('capabilitiesList');
        list.innerHTML = (capabilities[status] || capabilities.standard).map(s => `<li>${s}</li>`).join('');
      });
    });
  </script>
</body>
</html>
